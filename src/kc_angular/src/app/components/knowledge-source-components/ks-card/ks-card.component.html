<p-card class="ks-card">
  <ng-template pTemplate="header">
    <div *ngIf="showThumbnail">
      <p-skeleton width="100%" height="200px" *ngIf="!thumbnail && !thumbnailUnavailable"></p-skeleton>
      <div class="w-full p-fluid flex-col-center-center bg-auto">
        <p-image *ngIf="thumbnail" [src]="thumbnail"
                 class="align-self-center"
                 height="200px"
                 [preview]="true">
        </p-image>
        <div *ngIf="!thumbnail && thumbnailUnavailable"
             class="flex-col-center-center"
             style="height: 200px; width: 100%; background-color: var(--surface-400); border-radius: 10px">
          <app-ks-icon [ks]="ks"></app-ks-icon>
        </div>
      </div>
    </div>
  </ng-template>

  <ng-template pTemplate="title">
    <div class="grid p-fluid flex-row-center-between">
      <div class="col text-left">
        <h1>{{ks.title | truncate: [32]}}</h1>
        <h2 *ngIf="showContentType">Type: {{contentType | truncate: [24] | titlecase}}</h2>
        <h2 *ngIf="showProjectName">Project: {{ks.associatedProject | projectName | truncate: [24]}}</h2>
      </div>
      <div class="col-2 text-right">
        <app-ks-icon [ks]="ks"></app-ks-icon>
      </div>
    </div>
  </ng-template>

  <ng-template pTemplate="subtitle">

    <div class="grid p-fluid">
      <div class="col-12" *ngIf="showDescription && description">
        {{description}}
      </div>

      <div class="col-12" *ngIf="showProjectSelection">
        <p-treeSelect [(ngModel)]="selectedProject"
                      [options]="projectTreeNodes"
                      (onNodeSelect)="onProjectSelected($event)"
                      appendTo="body"
                      placeholder="Choose a Project">
        </p-treeSelect>
      </div>

    </div>
  </ng-template>

  <ng-template pTemplate="content">
        <h2 *ngIf="showTags && keywords && keywords.length"
            class="underline"
            pTooltip="{{keywords | topicList}}"
            tooltipPosition="bottom">
          Topics
        </h2>
        <h2 *ngIf="showTags && (!keywords || !keywords.length)"
            class="underline"
            pTooltip="No topics found"
            tooltipPosition="bottom">
          Topics
        </h2>
    <div *ngIf="showTags && showExpandedTags" [style]="{'height':'64px', 'overflow':'scroll'}">
      <p-chips [(ngModel)]="keywords"
               class="p-fluid w-full"
               (onChipClick)="onTopicClick.emit({ks: ks, topic: $event.value})"
               (onAdd)="onTopicAdd()"
               (onRemove)="onTopicRemove()"
               [addOnTab]="true"
               [addOnBlur]="true"
               [allowDuplicate]="false"
               placeholder="Add a Topic...">
      </p-chips>
    </div>
  </ng-template>
  <ng-template pTemplate="footer">
    <div class="col text-right">
      <button pButton *ngIf="showRemove"
              class="p-button-text"
              icon="pi pi-trash"
              (click)="onRemove.emit(this.ks)">
      </button>
      <button pButton *ngIf="showOpen"
              class="p-button-text"
              icon="pi pi-external-link"
              (click)="onOpen.emit(this.ks)">
      </button>
      <button pButton *ngIf="showEdit"
              class="p-button-text"
              icon="pi pi-pencil"
              (click)="onEdit.emit(this.ks)">
      </button>
      <button pButton *ngIf="showPreview"
              class="p-button-text"
              icon="pi pi-eye"
              (click)="onPreview.emit(this.ks)">
      </button>
    </div>
  </ng-template>
</p-card>
